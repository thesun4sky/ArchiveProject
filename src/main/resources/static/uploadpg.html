<!DOCTYPE html>
<html lang="en" ng-app="myUpload">
<head>
    <title>Upload</title>
    <link rel="icon" href="img/logoarchive.png" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/navi.css">
    <link rel="stylesheet" href="css/triangle.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <script type="text/javascript" src="http://beneposto.pl/jqueryrotate/js/jQueryRotateCompressed.js"></script>
    <style>
        /* Remove the navbar's default margin-bottom and rounded borders */
        .navbar {
            margin-bottom: 0;
            border-radius: 0;
        }

        /* Set height of the grid so .sidenav can be 100% (adjust as needed) */
        .row.content {height: 450px}

        footer {
            background-color: #555;
            color: white;
            padding: 15px;
        }
        /* On small screens, set height to 'auto' for sidenav and grid */
        @media screen and (max-width: 767px) {
            .sidenav {
                height: auto;
                padding: 15px;
            }
            .row.content {height:auto;}
        }
    </style>

</head>
<body ng-controller="uploadCtrl">

<!--메인헤더-->
<div ng-include="'mainHeader.html'"></div>
<!--서브헤더-->
<div ng-include="'subHeader.html'"></div>


<!--화면 분할 시작-->
<div class="container-fluid" style="margin-bottom: 50px;">
    <div class="row content">
        <!--좌측 화면분할-->
        <div class="col-sm-2 col-xs-2 sidenav hidden-xs" >
            <div class="container-fluid " >
                <p>좌측 화면 분할 </p>
            </div>
        </div>

        <!--가운데 콘텐츠 화면분할-->
        <div class="col-sm-8 col-xs-12">
            <!--게시작 작성 버튼을 누르면 이동하는 페이지-->
            <div ng-include="'upload.html'"></div>
        </div>


        <!--우측 화면 분할-->
        <div class="col-sm-2 hidden-xs sidenav">
            <div class="well">
                <p>ADS</p>
            </div>
            <div class="well">
                <p>ADS</p>
            </div>
        </div>
    </div>
</div>


<!--푸터-->
<div ng-include="'mainFooter.html'"></div>

<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
<script src="js/bootstrap.js"></script>
<!-- concatenated flow.js + ng-flow libraries -->
<script src="ng-flow/dist/ng-flow-standalone.min.js"></script>
<!-- or include the files separately -->
<script src="flow.js/dist/flow.min.js"></script>
<script src="ng-flow/dist/ng-flow.min.js"></script>
<script>
    var app3 = angular.module("myUpload",['flow']);
    app3.controller("uploadCtrl", function($scope, $http) {
        $scope.openAccess = [
            "전체공개", "Toline", "나만보기"
        ];
        $scope.catagory = [
            "영화", "연극", "콘서트", "드라마", "전시회", "음식", "여행", "음악"
        ];
        $scope.leftClass = function () {
            $scope.class_name = "left";
            $scope.multi_message = "좌측 정렬 되었습니다.";
        };
        $scope.centerClass = function () {
            $scope.class_name = "center";
            $scope.multi_message = "가운데 정렬 되었습니다.";
        };
        $scope.rightClass = function () {
            $scope.class_name = "right";
            $scope.multi_message = "우측 정렬 되었습니다.";

        };
        $scope.leftClass2 = function () {
            $scope.class_name2 = "left2";
            $scope.multi_message2 = "좌측 정렬 되었습니다.";
        };
        $scope.centerClass2 = function () {
            $scope.class_name2 = "center2";
            $scope.multi_message2 = "가운데 정렬 되었습니다.";
        };
        $scope.rightClass2 = function () {
            $scope.class_name2 = "right2";
            $scope.multi_message2 = "우측 정렬 되었습니다.";
        };
      $scope.lines = [
        {
          "firstLine": "",
          "secondLine": "",
            "tag1":"",
            "tag2":"",
            "tag3":""
        }
      ];
        $scope.positions = [
            {
                "divtop1": 0,
                "divleft1": 0
            }
        ];
        $scope.positions2 = [
            {
                "divtop2": 0,
                "divleft2": 0
            }
        ];


        $scope.sendPost = function (){
          var dataObject =
          {
            user_id: 1,
            public_level: 1,
            likes_num: 0,
            tag1: $scope.lines.tag1,
            tag2: $scope.lines.tag2,
            tag3: $scope.lines.tag3,
            line1: $scope.lines.firstLine,
            line1_x: $scope.positions.divleft1,
            line1_y: $scope.positions.divtop1,
            line2: $scope.lines.secondLine,
            line2_x: $scope.positions2.divleft2,
            line2_y: $scope.positions2.divtop2
          };
        $http({
            method: 'POST', //방식
            url: "/api/board", /* 통신할 URL */
            data: dataObject, /* 파라메터로 보낼 데이터 */
            headers: {'enctype': 'multipart/form-data; charset=utf-8'} //헤더
        })
                .success(function (data, status, headers, config) {
                    if(data.msg == 'false') {
                        alert('게시글 업로드 실패')
                    }else{
                        alert('게시글 업로드 성공');
                        window.location.href = 'index.html';
                    }
                })
                .error(function (data, status, headers, config) {
                    /* 서버와의 연결이 정상적이지 않을 때 처리 */
                    console.log(status);
                });
    };
    });
    app3.directive('draggable', function () {
        return {
            restrict: 'A',
            link: function (scope, element, attrs) {
                element.draggable({
                    cursor: "move",
                    stop: function (event, ui) {
                        scope[attrs.xpos] = ui.position.left;
                        scope[attrs.ypos] = ui.position.top;
                        scope.$apply();
                    }
                });
            }
        };
    });

</script>


</body>
</html>
