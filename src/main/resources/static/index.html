<!DOCTYPE html>
<html lang="en">
<head>
    <title>Main</title>
    <link rel="icon" href="img/logoarchive.png" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/navi.css">
    <link rel="stylesheet" href="css/findnavi.css">
    <link rel="stylesheet" href="css/sign-in.css">
    <link rel="stylesheet" href="css/triangle.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script type="text/javascript" src="http://beneposto.pl/jqueryrotate/js/jQueryRotateCompressed.js"></script>
    <script>
        $(document).ready(function(){
            $(function () {
                // Remove Search if user Resets Form or hits Escape!
                $('body, .navbar-collapse form[role="search"] button[type="reset"]').on('click keyup', function(event) {
                    console.log(event.currentTarget);
                    $("#srch1").removeClass("important");
                    $("#srch1").addClass("search-default");
                    if (event.which == 27 && $('.navbar-collapse form[role="search"]').hasClass('active') ||
                            $(event.currentTarget).attr('type') == 'reset') {
                        closeSearch();
                    }
                });

                function closeSearch() {
                    var $form = $('.navbar-collapse form[role="search"].active')
                    $form.find('input').val('');
                    $form.removeClass('active');
                    $form.addClass('comeback');
                }

                // Show Search if form is not active // event.preventDefault() is important, this prevents the form from submitting
                $(document).on('click', '.navbar-collapse form[role="search"]:not(.active) button[type="submit"]', function(event) {
                    event.preventDefault();
                    $("#srch1").removeClass("search-default");
                    $("#srch1").addClass("important");
                    var $form = $(this).closest('form'),
                            $input = $form.find('input');
                    $form.removeClass('comeback');
                    $form.addClass('active');
                    $input.focus();
                });

                // Autofocus for collapsed mode
                $(document).on('click', '.navbar-header button.navbar-toggle:last-of-type', function(event) {
                    var $form = $('.navbar-collapse form[role="search"]').find('input').focus();
                });

                // ONLY FOR DEMO // Please use $('form').submit(function(event)) to track from submission
                // if your form is ajax remember to call `closeSearch()` to close the search container
                $(document).on('click', '.navbar-collapse form[role="search"].active button[type="submit"]', function(event) {
                    event.preventDefault();
                    var $form = $(this).closest('form'),
                            $input = $form.find('input');
                    $('#showSearchTerm').text($input.val());
                    closeSearch()
                });
            });
        });
    </script>

    <style>
        /* Remove the navbar's default margin-bottom and rounded borders */
        .navbar {
            margin-bottom: 0;
            border-radius: 0;
        }

        /* Set height of the grid so .sidenav can be 100% (adjust as needed) */
        .row.content {height: 450px}

        footer {
            background-color: #555;
            color: white;
            padding: 15px;
        }

        /* On small screens, set height to 'auto' for sidenav and grid */
        @media screen and (max-width: 767px) {
            .sidenav {
                height: auto;
                padding: 15px;
            }
            .row.content {height:auto;}
        }
    </style>

</head>
<body ng-app="homeApp" ng-controller="homeCtrl">

<!--메인헤더-->
<div ng-include="'mainHeader.html'"></div>
<!--서브헤더-->
<div ng-include="'subHeader.html'"></div>


<!--화면 분할 시작-->
<div class="container-fluid" style="margin-bottom: 50px;">
    <div class="row content">
        <!--좌측 화면분할-->
        <div class="col-sm-1 col-xs-1 sidenav hidden-xs" >
            <div class="container-fluid " >
                <p> </p>
            </div>
        </div>

        <!--가운데 콘텐츠 화면분할-->
        <div class="col-sm-9 col-xs-12">
            <div ng-include="'homepg.html'"></div>
        </div>


        <!--우측 화면 분할-->
        <div class="col-sm-2 hidden-xs sidenav">
            <div class="well">
                <p>ADS</p>
            </div>
            <div class="well">
                <p>ADS</p>
            </div>
        </div>
    </div>
</div>


<!--푸터-->
<div ng-include="'mainFooter.html'"></div>
<script src="js/load.js"></script>
<script src="js/bootstrap.js"></script>
<script>
    var app0 = angular.module("homeApp",[]);
    app0.controller("homeCtrl",function($scope, $http){

        //TODO: 로그인 정보를 토큰에서 받는것으로 변경하기

        $scope.name = "김태선";
        var loginObject = {
            user_id : 1
        };

        $http({
            method: 'POST', //방식
            url: "/api/boardlist", /* 통신할 URL */
            data: loginObject, /* 파라메터로 보낼 데이터 */
            headers: {'Content-Type': 'application/json; charset=utf-8'} //헤더
        })
                .then(function(response) {
                    $scope.boards = response.data;
                });

        $scope.favoriteBoard = function (board_id){
            var favoriteBoardObject =
            {
                user_id: 1, //임시로 1번사용자 지정
                board_id: board_id
            };
            $http({
                method: 'POST', //방식
                url: "/api/favoriteBoard", /* 통신할 URL */
                data: favoriteBoardObject, /* 파라메터로 보낼 데이터 */
                headers: {'Content-Type': 'application/json; charset=utf-8'} //헤더
            })
                    .success(function (data, status, headers, config) {
                        if(data.msg == 'false') {
                            alert('페이버릿 실패')
                        }else{
                            alert('페이버릿 성공');
                        }
                    })
                    .error(function (data, status, headers, config) {
                        /* 서버와의 연결이 정상적이지 않을 때 처리 */
                        console.log(status);
                    });
        };

        $scope.UnfavoriteBoard = function (board_id){
            var UnfavoriteBoardObject =
            {
                user_id: 1, //임시로 1번사용자 지정
                board_id: board_id
            };
            $http({
                method: 'POST', //방식
                url: "/api/UnfavoriteBoard", /* 통신할 URL */
                data: UnfavoriteBoardObject, /* 파라메터로 보낼 데이터 */
                headers: {'Content-Type': 'application/json; charset=utf-8'} //헤더
            })
                    .success(function (data, status, headers, config) {
                        if(data.msg == 'false') {
                            alert('페이버릿취소 실패')
                        }else{
                            alert('페이버릿취소 성공');
                        }
                    })
                    .error(function (data, status, headers, config) {
                        /* 서버와의 연결이 정상적이지 않을 때 처리 */
                        console.log(status);
                    });
        };

    });


    //        GET방식
    //        var app = angular.module("homeApp" ,[]);
    //        app.controller("homeCtrl",function($scope, $http){
    //            $http.get("/api/getboardlist")
    //                    .then(function(response) {
    //                        $scope.boards = response.data;
    //                    });
    //        });

</script>
</body>
</html>
